load keyGen.sage
load RSAEncrypt.sage
load CommonMod.sage

m = "1234567890123456789012345678901234567890123456789012345678901234567890"\
"1234567890123456789012345678901234567890123456789012345678901234567890"\
"1234567890123456789012345678901234567890123456789012345678901234567890"\
"1234567890123456789012345678901234567890123456789012345678901234567890"
m = long(m)

(p,q,e,d,n,phi_n) = keyGen()
(p,q,e1,d,n,phi_n) = keyGenGivenN(p,q,17)			#e1 = 17
(p,q,e2,d,n,phi_n) = keyGenGivenN(p,q,(1<<16)+1)	#e2 = 2^16+1

c1 = RSAEncrypt(m,e1,n)
c2 = RSAEncrypt(m,e2,n)

mAttack = commonMod(c1,e1,c2,e2,n)
print(mAttack)